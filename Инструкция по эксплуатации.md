# Гибридная система для точной симуляции Большого адронного коллайдера (БАК)

<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/c480135c-86bf-44b1-acd5-e7bda4b0289d" />

## Описание

Представленная система представляет собой **полнофункциональный гибридный эмулятор Большого адронного коллайдера (БАК)**, объединяющий точную математическую модель, интеграцию с профессиональными инструментами физики высоких энергий и современные методы визуализации.

Это не просто учебная модель, а **комплексный научный инструмент**, способный выполнять симуляции на уровне, близком к реальным условиям работы БАК. Система разработана для решения широкого круга задач в области физики частиц, от образования до анализа данных.

### Ключевые особенности

1.  **Гибридная архитектура:** Система объединяет несколько физических движков:
    *   **Встроенный движок:** Для базовых симуляций и обучения.
    *   **PYTHIA:** Для детального моделирования QCD-процессов и генерации событий.
    *   **Geant4:** Для реалистичного моделирования взаимодействия частиц с детекторами.
    *   **MAD-X:** Для точного моделирования динамики пучка в магнитном поле.
2.  **Интеграция с реальными данными:** Система напрямую подключается к **CERN Open Data Portal**, что позволяет:
    *   Загружать актуальные параметры БАК (энергия, светимость, конфигурация пучка).
    *   Сравнивать результаты симуляции с реальными данными столкновений.
    *   Автоматически калибровать модель для повышения точности.
3.  **GPU-ускорение:** Использование библиотек `Numba` и `CuPy` обеспечивает параллельную обработку и ускорение вычислений, особенно при трассировке траекторий тысяч частиц.
4.  **Система кэширования:** Кэширование результатов симуляций значительно ускоряет повторные расчеты с одинаковыми параметрами.
5.  **Полноценная визуализация:** Система поддерживает как базовую визуализацию на `matplotlib`, так и интерактивную 3D-визуализацию на `Plotly`, включая траектории частиц, линии магнитного поля и отклик детекторов.
6.  **Экспорт в стандартные форматы:** Результаты могут быть экспортированы в формат `ROOT`, что позволяет использовать их в стандартных пакетах анализа данных физики частиц.

---

## Настройка

Для работы с системой необходимо выполнить следующие шаги:

### 1. Установка зависимостей

Система требует установки следующих пакетов Python. Рекомендуется использовать виртуальное окружение.

```bash
pip install numpy matplotlib scipy requests pyyaml numba cupy-cuda11x plotly rootpy
```

**Примечания:**
*   `cupy-cuda11x`: Замените на версию, соответствующую вашей версии CUDA (например, `cupy-cuda12x`). Если CUDA недоступна, GPU-ускорение работать не будет.
*   `rootpy`: Упрощает работу с ROOT. Для полной интеграции с `ROOT` может потребоваться установка самого фреймворка ROOT.
*   `geant4`, `pythia8`, `madx`: Эти профессиональные инструменты требуют сложной установки, часто из исходного кода. Если они недоступны, система автоматически переключается на встроенные модели.

### 2. Конфигурационный файл

Создайте файл `lhc_config.yaml` в директории с кодом. Этот файл позволяет настроить параметры симуляции.

```yaml
beam:
  energy: 6500             # Энергия пучка в ГэВ
  particles: "protons"     # Тип частиц
  bunch_intensity: 1.15e11 # Частиц в одном сгустке
  num_bunches: 2748        # Количество сгустков

geometry:
  circumference: 26658.883 # Длина окружности кольца в метрах
  dipole_field: 8.33       # Магнитное поле дипольных магнитов в Тл

validation:
  dataset_id: "cms-2011-collision-data" # Идентификатор набора данных для валидации
```

### 3. Запуск системы

<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/ec33ff08-9d8a-4a08-9452-606ca2198406" />

Сохраните полный код в файл, например, `lhc_hybrid_simulator.py`, и запустите:

```bash
python lhc_hybrid_simulator.py
```

Система автоматически:
1.  Проверит наличие конфигурационного файла и создаст его, если он отсутствует.
2.  Проинициализирует все компоненты (физические движки, геометрию, детекторы).
3.  Выполнит серию демонстрационных симуляций.

---

## Примеры решаемых задач

Гибридная система способна решать широкий спектр задач, от фундаментальных исследований до образовательных целей.

### 1. Моделирование физических процессов при столкновениях

**Задача:** Исследовать вероятность и продукты различных типов взаимодействий при заданной энергии.

**Пример кода:**
```python
# Создание модели
lhc = LHCHybridModel()

# Моделирование 1000 протон-протонных столкновений при 13 ТэВ
events = lhc.physics_engine.interact('proton', 'proton', energy=13000, num_events=1000, model='standard')

# Анализ продуктов
w_events = [e for e in events if e['event_type'] == 'w_production']
z_events = [e for e in events if e['event_type'] == 'z_production']
higgs_events = [e for e in events if e['event_type'] == 'higgs_production']

print(f"Произведено W-бозонов: {len(w_events)}")
print(f"Произведено Z-бозонов: {len(z_events)}")
print(f"Произведено бозонов Хиггса: {len(higgs_events)}")
```

**Решаемые вопросы:**
*   Как изменяется сечение производства W/Z-бозонов с ростом энергии?
*   Каковы основные каналы распада бозона Хиггса?
*   Как выглядят события с производством тяжелых топ-кварков?

### 2. Исследование динамики пучка и оптимизация параметров

**Задача:** Изучить, как эмиттанс, размер пучка и светимость изменяются во времени из-за эффектов пространственного заряда и потерь частиц.

**Пример кода:**
```python
# Запуск симуляции на 100 оборотов
lhc.run_simulation(num_turns=100, include_space_charge=True)

# Получение данных о динамике пучка
dynamics = lhc.simulation_state['beam_dynamics']

# Построение графика светимости
plt.plot(dynamics['time'], dynamics['luminosity'])
plt.xlabel('Время (с)')
plt.ylabel('Светимость (см⁻²с⁻¹)')
plt.title('Деградация светимости из-за эффектов пространственного заряда')
plt.show()
```

**Решаемые вопросы:**
*   Каковы причины падения светимости во время запуска?
*   Как влияет интенсивность пучка на его стабильность?
*   Какие параметры фокусировки (бета-функция) оптимальны для максимизации светимости?

### 3. Валидация модели и калибровка

**Задача:** Убедиться, что модель точно отражает реальную работу БАК, и скорректировать ее параметры.

**Пример кода:**
```python
# Загрузка реальных данных из CERN Open Data
lhc.validation_system.load_real_data("cms-2011-collision-data")

# Валидация светимости и эмиттанса
luminosity_error = lhc.validation_system.validate_luminosity()
emittance_error = lhc.validation_system.validate_emittance()

# Автоматическая калибровка
if luminosity_error > 0.1 or emittance_error > 0.1:
    lhc.validation_system.autocalibrate()
    lhc.validation_system.save_calibration_data()
```

**Решаемые вопросы:**
*   Насколько точно модель предсказывает пиковые значения светимости?
*   Соответствуют ли смоделированные размеры пучка реальным измерениям?
*   Какие калибровочные коэффициенты необходимо применить для достижения высокой точности?

### 4. Образовательные и демонстрационные цели

**Задача:** Наглядно показать принцип работы коллайдера и физику элементарных частиц.

**Пример кода:**
```python
# Запуск упрощенной учебной симуляции
demo_educational_simulation()

# Визуализация траекторий частиц после столкновения
lhc._visualize_particle_tracks()

# Построение энергетического спектра продуктов распада Z-бозона
lhc.data_analyzer.plot_histogram('energy_spectrum', title='Распад Z⁰ → e⁺e⁻')
```

**Решаемые вопросы:**
*   Как выглядит траектория частиц в магнитном поле дипольных и квадрупольных магнитов?
*   Какие продукты образуются при распаде Z-бозона?
*   Как детекторы реконструируют энергию и импульс частиц?

### 5. Исследование "новой физики"

**Задача:** Поиск аномалий или редких событий, которые могут указывать на физику за пределами Стандартной модели.

**Пример кода:**
```python
# Моделирование с повышенной вероятностью "новой физики"
events = lhc.physics_engine.interact('proton', 'proton', energy=13000, num_events=10000, model='beyond_sm')

# Фильтрация событий с высокой пропущенной энергией (признак нейтрино или темной материи)
new_physics_events = [e for e in events if e['event_type'] == 'new_physics']

# Анализ распределения пропущенной энергии
missing_energy = [e['missing_energy'] for e in new_physics_events]
plt.hist(missing_energy, bins=50)
plt.xlabel('Пропущенная энергия (ГэВ)')
plt.ylabel('Число событий')
plt.title('Поиск признаков новой физики')
plt.show()
```

**Решаемые вопросы:**
*   Каковы ожидаемые сигнатуры новых частиц (например, темной материи)?
*   Как отличить редкое событие Стандартной модели от признака новой физики?
*   Какие стратегии триггеров можно использовать для отбора интересных событий?

---

## Заключение

Представленная гибридная система является мощным и гибким инструментом для симуляции работы Большого адронного коллайдера. Она успешно объединяет теоретическую физику, численные методы, интеграцию с реальными данными и современные технологии визуализации, что делает ее ценным ресурсом как для научных исследований, так и для образования в области физики высоких энергий.
